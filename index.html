<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Zombie Survival — Sprite Edition</title>
  <style>
    html,body{height:100%;margin:0;background:#0b1220;font-family:Inter,system-ui,Segoe UI,Roboto,Arial;}
    canvas{display:block;margin:0 auto;background:#1e2a38;box-shadow:0 6px 30px rgba(0,0,0,0.6);border-radius:8px;}
    .hud{position:fixed;left:20px;top:20px;color:#fff;font-weight:600;}
    .hud .line{font-size:14px;margin:2px 0;}
    .center-ui{position:fixed;left:50%;transform:translateX(-50%);top:20px;color:#fff;text-align:center;}
    .controls{position:fixed;right:20px;top:20px;color:#cfe3ff;text-align:right;font-size:13px}
    #shopUI{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:#222;padding:20px;border-radius:10px;color:#fff;text-align:center;display:none;}
    #shopUI h2{margin:0 0 10px 0;}
    #shopUI button{display:block;margin:6px auto;padding:8px 16px;border:none;border-radius:6px;background:#4a6bff;color:#fff;font-weight:bold;cursor:pointer;}
    #shopUI button:hover{background:#6a8dff;}
    #pausedOverlay{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.6);color:#fff;font-size:36px;display:none;align-items:center;justify-content:center;}
  </style>
</head>
<body>
  <div class="hud">
    <div class="line" id="hp">HP: 100</div>
    <div class="line" id="stamina">Stamina: 100</div>
    <div class="line" id="ammo">Ammo: 120/120</div>
    <div class="line" id="money">Money: $0</div>
  </div>
  <div class="center-ui"><div class="wave" id="waveTag">Wave 1 / 20</div></div>
  <div class="controls">
    <div>WASD to move • Shift to sprint • Mouse to aim</div>
    <div>Click to shoot • P to pause • R to restart after death</div>
  </div>
  <div id="shopUI">
    <h2>Shop</h2>
    <button onclick="buyUpgrade('hp')">+20 Max Health</button>
    <button onclick="buyUpgrade('stamina')">+20 Max Stamina</button>
    <button onclick="buyUpgrade('ammo')">Refill Ammo</button>
    <button onclick="buyUpgrade('gun')">Buy Better Gun</button>
    <button onclick="skipShop()">Skip Shop</button>
  </div>
  <div id="pausedOverlay">PAUSED</div>
  <canvas id="game" width="1100" height="700"></canvas>

<script>
const CONFIG = {width:1100,height:700,maxWaves:20,playerSpeed:180,sprintMult:1.7,bulletSpeed:700,fireRate:280};

const cvs=document.getElementById('game');const ctx=cvs.getContext('2d');ctx.imageSmoothingEnabled=false;

// Load individual sprite PNGs
const SPRITES = {
  player: new Image(), zombie: new Image(), werewolf: new Image(), robot: new Image(),
  grass: new Image(), tree: new Image(), rock: new Image(), crate: new Image(),
  pistol: new Image(), rifle: new Image(), shotgun: new Image()
};

SPRITES.player.src = "assets/sprites/player_inter.png";
SPRITES.zombie.src = "assets/sprites/zombie_inter.png";
SPRITES.werewolf.src = "assets/sprites/werewolf_inter.png";
SPRITES.robot.src = "assets/sprites/robot_Inter.png";
SPRITES.grass.src = "assets/sprites/grass_inter.png";
SPRITES.tree.src = "assets/sprites/tree_inter.png";
SPRITES.rock.src = "assets/sprites/rock_inter.png";
SPRITES.crate.src = "assets/sprites/crate_inter.png";
SPRITES.pistol.src = "assets/sprites/pistol_inter.png";
SPRITES.rifle.src = "assets/sprites/rifle_inter.png";
SPRITES.shotgun.src = "assets/sprites/shotgun_inter.png";

// Draw helper
function drawSprite(name, x, y, scale = 1) {
  const img = SPRITES[name];
  if (!img.complete) return;
  const w = img.width * scale;
  const h = img.height * scale;
  ctx.drawImage(img, Math.floor(x - w / 2), Math.floor(y - h / 2), w, h);
}

let keys={},mouse={x:CONFIG.width/2,y:CONFIG.height/2,down:false};
window.addEventListener('keydown',e=>{keys[e.key.toLowerCase()]=true;if(e.key.toLowerCase()==='p'){togglePause();}if(e.key.toLowerCase()==='r'&&game.ended)restartGame();});
window.addEventListener('keyup',e=>{keys[e.key.toLowerCase()]=false});
cvs.addEventListener('mousemove',e=>{const rect=cvs.getBoundingClientRect();mouse.x=(e.clientX-rect.left)*(cvs.width/rect.width);mouse.y=(e.clientY-rect.top)*(cvs.height/rect.height);});
cvs.addEventListener('mousedown',()=>mouse.down=true);
cvs.addEventListener('mouseup',()=>mouse.down=false);

let game={player:null,bullets:[],enemies:[],wave:1,money:0,ammo:120,maxAmmo:120,stamina:100,maxStamina:100,hp:100,maxHp:100,lastShot:0,paused:false,ended:false};
let shopCosts={hp:100,stamina:120,ammo:50,gun:200};

function createPlayer(){return{x:CONFIG.width/2,y:CONFIG.height/2,speed:CONFIG.playerSpeed}};

function spawnEnemy(){let type='zombie';if(game.wave>=12&&Math.random()<0.3)type='robot';else if(game.wave>=7&&Math.random()<0.5)type='werewolf';
let hp=30;if(type==='zombie')hp=20+game.wave*3;if(type==='werewolf')hp=40+game.wave*4;if(type==='robot')hp=80+game.wave*6;
game.enemies.push({x:Math.random()*CONFIG.width,y:Math.random()*CONFIG.height,type,hp});}

function update(dt){if(game.paused||game.ended)return;
const p=game.player;let dx=0,dy=0;if(keys['w'])dy-=1;if(keys['s'])dy+=1;if(keys['a'])dx-=1;if(keys['d'])dx+=1;let mag=Math.hypot(dx,dy)||1;dx/=mag;dy/=mag;let speed=p.speed;
if(keys['shift']&&game.stamina>0){speed*=CONFIG.sprintMult;game.stamina-=30*dt;}else{game.stamina=Math.min(game.maxStamina,game.stamina+15*dt);}if(game.stamina<0)game.stamina=0;
p.x+=dx*speed*dt;p.y+=dy*speed*dt;p.x=Math.max(16,Math.min(CONFIG.width-16,p.x));p.y=Math.max(16,Math.min(CONFIG.height-16,p.y));

if(mouse.down&&performance.now()-game.lastShot>CONFIG.fireRate&&game.ammo>0){game.lastShot=performance.now();game.ammo--;game.bullets.push({x:p.x,y:p.y,vx:(mouse.x-p.x)/Math.hypot(mouse.x-p.x,mouse.y-p.y)*CONFIG.bulletSpeed,vy:(mouse.y-p.y)/Math.hypot(mouse.x-p.x,mouse.y-p.y)*CONFIG.bulletSpeed,life:1});}

for(let b of game.bullets){b.x+=b.vx*dt;b.y+=b.vy*dt;b.life-=dt;}game.bullets=game.bullets.filter(b=>b.life>0);
for(let e of game.enemies){const ang=Math.atan2(p.y-e.y,p.x-e.x);if(e.type==='werewolf'){e.x+=Math.cos(ang)*100*dt;e.y+=Math.sin(ang)*100*dt;}else if(e.type==='robot'){e.x+=Math.cos(ang)*40*dt;e.y+=Math.sin(ang)*40*dt;}else{e.x+=Math.cos(ang)*60*dt;e.y+=Math.sin(ang)*60*dt;}}

for(let b of game.bullets){for(let e of game.enemies){if(Math.hypot(b.x-e.x,b.y-e.y)<20){e.hp-=20;b.life=0;if(e.hp<=0){game.money+=20;}}}}
game.enemies=game.enemies.filter(e=>e.hp>0);

if(game.enemies.length===0){if(game.wave%3===0){openShop();}else{game.wave++;for(let i=0;i<5+game.wave*2;i++)spawnEnemy();}}}

function render(){ctx.clearRect(0,0,CONFIG.width,CONFIG.height);
for(let x=0;x<CONFIG.width;x+=32){for(let y=0;y<CONFIG.height;y+=32){drawSprite('grass',x+16,y+16,1);}}
for(let e of game.enemies){drawSprite(e.type,e.x,e.y,1);}
for(let b of game.bullets){ctx.fillStyle='#ffd27a';ctx.fillRect(b.x-2,b.y-2,4,4);}
const p=game.player;drawSprite('player',p.x,p.y,1);}

function loop(ts){if(!lastTime)lastTime=ts;let dt=(ts-lastTime)/1000;lastTime=ts;update(dt);render();updateHUD();requestAnimationFrame(loop);}let lastTime=0;

function updateHUD(){document.getElementById('hp').textContent=`HP: ${Math.round(game.hp)}/${game.maxHp}`;document.getElementById('stamina').textContent=`Stamina: ${Math.round(game.stamina)}/${game.maxStamina}`;document.getElementById('ammo').textContent=`Ammo: ${game.ammo}/${game.maxAmmo}`;document.getElementById('money').textContent=`Money: $${game.money}`;document.getElementById('waveTag').textContent=`Wave ${game.wave}/${CONFIG.maxWaves}`;}

function togglePause(){game.paused=!game.paused;document.getElementById('pausedOverlay').style.display=game.paused?'flex':'none';}

function openShop(){game.paused=true;document.getElementById('shopUI').style.display='block';}
function skipShop(){document.getElementById('shopUI').style.display='none';game.paused=false;game.wave++;for(let i=0;i<5+game.wave*2;i++)spawnEnemy();}
function buyUpgrade(type){if(game.money<shopCosts[type])return;if(type==='hp'){game.maxHp+=20;game.hp=game.maxHp;}if(type==='stamina'){game.maxStamina+=20;game.stamina=game.maxStamina;}if(type==='ammo'){game.ammo=game.maxAmmo;}if(type==='gun'){CONFIG.fireRate=Math.max(120,CONFIG.fireRate-40);}game.money-=shopCosts[type];shopCosts[type]=Math.round(shopCosts[type]*1.4);}

function restartGame(){game={player:createPlayer(),bullets:[],enemies:[],wave:1,money:0,ammo:120,maxAmmo:120,stamina:100,maxStamina:100,hp:100,maxHp:100,lastShot:0,paused:false,ended:false};for(let i=0;i<5+game.wave*2;i++)spawnEnemy();}

restartGame();requestAnimationFrame(loop);
</script>
</body>
</html>
